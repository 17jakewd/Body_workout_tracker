<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Nightwing Calisthenics — Tracker</title>
<meta name="description" content="Lightweight calisthenics tracker & reminders for Nightwing build.">
<style>
  :root{
    --bg:#0b0f14; --card:#0f1720; --muted:#9aa7b4; --accent:#1fb6ff; --accent2:#7effa1;
    --glass: rgba(255,255,255,0.03);
    font-family: Inter, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
    color: #e6eef6;
  }
  html,body{height:100%;margin:0;background:
    linear-gradient(180deg,#071426 0%, #05121a 100%); -webkit-font-smoothing:antialiased;}
  .wrap {max-width:980px;margin:20px auto;padding:18px;}
  header{display:flex;gap:12px;align-items:center;margin-bottom:12px}
  h1{margin:0;font-size:20px}
  .subtitle{color:var(--muted);font-size:13px}
  .grid{display:grid;grid-template-columns: 1fr 340px;gap:16px}
  .card{background:var(--card);padding:14px;border-radius:12px;box-shadow:0 6px 18px rgba(3,8,15,0.6)}
  .small{font-size:13px;color:var(--muted)}
  .workout-list{display:flex;flex-direction:column;gap:8px}
  .workout-item{display:flex;justify-content:space-between;align-items:center;padding:10px;border-radius:8px;background:var(--glass)}
  button{background:linear-gradient(90deg,var(--accent),var(--accent2));border:0;color:#021016;padding:8px 10px;border-radius:8px;cursor:pointer;font-weight:600}
  .btn-ghost{background:transparent;border:1px solid rgba(255,255,255,0.06);color:var(--muted);padding:8px;border-radius:8px}
  .ex-list{max-height:340px;overflow:auto;padding-right:6px}
  .ex-item{padding:10px;border-radius:8px;background:rgba(255,255,255,0.02);margin-bottom:8px}
  details summary{cursor:pointer;outline:none}
  label{display:block;font-size:13px;margin-bottom:6px;color:var(--muted)}
  input,select{width:100%;padding:8px;border-radius:8px;border:0;background:#08121a;color:var(--muted)}
  .row{display:flex;gap:8px}
  .tracker-grid{display:grid;grid-template-columns:1fr 100px 100px;gap:8px;align-items:center}
  .log{max-height:200px;overflow:auto;padding-top:8px}
  footer{margin-top:12px;color:var(--muted);font-size:12px;text-align:center}
  .top-actions{margin-left:auto;display:flex;gap:8px}
  @media(max-width:880px){.grid{grid-template-columns:1fr;}.top-actions{display:none}}
</style>
</head>
<body>
<div class="wrap">
  <header>
    <div>
      <h1>Nightwing Calisthenics — Tracker</h1>
      <div class="subtitle">4x/week bodyweight routine + gym integration • Built for 5'10", 69kg, lean</div>
    </div>
    <div class="top-actions">
      <button id="askNotify">Enable Reminders</button>
      <button id="exportBtn" class="btn-ghost">Export</button>
      <button id="importBtn" class="btn-ghost">Import</button>
    </div>
  </header>

  <div class="grid">
    <div class="card">
      <h3 style="margin:0 0 8px 0">Weekly Schedule & Start</h3>
      <div class="small">Suggested integration with your 5x gym schedule. Calisthenics are the 4 listed days below.</div>
      <div style="margin-top:12px" class="workout-list" id="scheduleList"></div>

      <hr style="border:none;border-top:1px solid rgba(255,255,255,0.03);margin:12px 0">

      <div style="display:flex;gap:8px;align-items:center">
        <div style="flex:1">
          <label>Set reminder time for selected workout</label>
          <input id="remTime" type="time" value="18:30" />
        </div>
        <div style="align-self:end">
          <button id="setRem">Set</button>
        </div>
      </div>

      <hr style="border:none;border-top:1px solid rgba(255,255,255,0.03);margin:12px 0">

      <h3 style="margin:0 0 8px 0">Today / Quick Start</h3>
      <div class="small" id="todayLabel">—</div>
      <div style="margin-top:8px" id="todayActions"></div>

      <hr style="border:none;border-top:1px solid rgba(255,255,255,0.03);margin:12px 0">

      <h3 style="margin:0 0 8px 0">Progress Log</h3>
      <div class="log card" id="logArea" style="background:transparent;box-shadow:none;padding:0"></div>
    </div>

    <aside class="card">
      <div style="display:flex;align-items:center;gap:10px;justify-content:space-between">
        <div>
          <div style="font-weight:700">Exercises & How-to</div>
          <div class="small">Tap any exercise to expand technique and progressions.</div>
        </div>
        <div>
          <select id="filterSelect">
            <option value="all">All</option>
            <option value="push">Push</option>
            <option value="pull">Pull</option>
            <option value="core">Core</option>
            <option value="explosive">Explosive</option>
          </select>
        </div>
      </div>

      <div class="ex-list" id="exList" style="margin-top:10px"></div>

      <hr style="border:none;border-top:1px solid rgba(255,255,255,0.03);margin:12px 0">

      <h4 style="margin:0 0 8px 0">Quick tracker</h4>
      <div class="small">Select a workout, log sets and reps quickly.</div>
      <div style="margin-top:8px">
        <label>Workout</label>
        <select id="selectWorkout"></select>
        <label style="margin-top:8px">Exercise</label>
        <select id="selectExercise"></select>
        <div class="row" style="margin-top:8px">
          <input id="inputSets" type="number" min="1" placeholder="Sets" value="4" />
          <input id="inputReps" type="text" placeholder="Reps or time (e.g. 8-10 or 30s)" />
        </div>
        <div style="display:flex;gap:8px;margin-top:8px">
          <button id="logBtn">Log</button>
          <button id="clearBtn" class="btn-ghost">Clear Logs</button>
        </div>
      </div>
    </aside>
  </div>

  <footer>Built for your Nightwing goal • Keep calories slightly above maintenance with protein for muscle build • Track progress weekly.</footer>
</div>

<script>
/* ====== Data: workouts + exercises with descriptions/progressions ====== */
const WORKOUTS = [
  { id:'push', title:'Day A — Push Power (chest/shoulders/triceps)', tag:'push', exercises:[
    'Archer push-ups','Pseudo planche push-ups','Pike push-ups','Dips','L-sit hold'
  ]},
  { id:'pull', title:'Day B — Pull Power (back/biceps)', tag:'pull', exercises:[
    'Pull-ups','Archer pull-ups','Front lever raises','Chin-ups','Hanging leg raises'
  ]},
  { id:'core', title:'Day C — Core & Mobility', tag:'core', exercises:[
    'Hanging windshield wipers','Dragon flags','Hollow body hold','Side plank reach-throughs','Mobility flow'
  ]},
  { id:'explosive', title:'Day D — Explosive & Agility', tag:'explosive', exercises:[
    'Clap push-ups','Muscle-up progressions','Jump squats','Burpee pull-ups','Sprint intervals'
  ]}
];

const EXERCISE_DB = {
  'Archer push-ups':{
    type:'push', level:'intermediate',
    desc:'Wide push-up where you shift weight laterally to load one side more. Excellent for single-arm transfer strength.',
    steps:[
      'Start in a wide push-up stance.',
      'Shift weight to one hand and extend the opposite arm straight to the side.',
      'Lower under control, push back up using the loaded side.',
      'Progressions: wide push-up → archer incline → full archer.'
    ],
    tips:'Keep hips level, control range, breathe steadily.'
  },
  'Pseudo planche push-ups':{
    type:'push', level:'advanced',
    desc:'Leans forward to increase shoulder demand; trains planche-like balance.',
    steps:[
      'Place hands lower near hips, fingers pointed back slightly.',
      'Lean forward while doing push-ups so shoulders travel past wrists.',
      'Keep core braced, elbows tucked slightly.',
      'Progress: incline pseudo → floor → weighted.'
    ],
    tips:'Work wrist mobility to avoid soreness.'
  },
  'Pike push-ups':{
    type:'push', level:'intermediate',
    desc:'Shoulder-dominant push-up that builds press strength and HSPU foundation.',
    steps:[
      'Start in a pike position (hips high, body V-shaped).',
      'Lower crown of head toward ground between hands and press up.',
      'Progress to elevated feet, then partial handstand push-ups.'
    ],
    tips:'Keep neck neutral; use mats for head protection.'
  },
  'Dips':{
    type:'push', level:'intermediate',
    desc:'Triceps and chest builder; use rings or bars.',
    steps:[
      'Grip bars or rings firmly; lock shoulders and descend controlled.',
      'Go to ~90 degrees elbow or deeper for chest emphasis.',
      'Add weight as you progress.'
    ],
    tips:'Lean slightly forward for chest, upright for triceps.'
  },
  'L-sit hold':{
    type:'core', level:'intermediate',
    desc:'Intense core and hip flexor isometric hold—key for rings control.',
    steps:[
      'From seated, press into parallel bars or floor with hands.',
      'Raise legs straight into an L shape and hold.',
      'Progress: tuck L-sit → one leg extended → full L.'
    ],
    tips:'Squeeze quads and point toes; small holds repeatedly build time.'
  },
  'Pull-ups':{
    type:'pull', level:'intermediate',
    desc:'Primary back vertical pull. Train full ROM and strength with progressive loading.',
    steps:[
      'Dead hang, scapula retraction then pull chin above bar.',
      'Lower controlled to full hang.',
      'Add weight or slow eccentrics for progression.'
    ],
    tips:'Mix grips (pronated/supinated) for balance.'
  },
  'Archer pull-ups':{
    type:'pull', level:'advanced',
    desc:'Single-side biased pull-up building unilateral pulling strength.',
    steps:[
      'Wide grip; pull up and shift chest to one hand, extending the other.',
      'Alternate sides; use tuck-assisted variation to progress.'
    ],
    tips:'Use slow negatives if reps are low.'
  },
  'Front lever raises':{
    type:'pull', level:'advanced',
    desc:'Front lever is a high-skill core + lats hold. Raises train the movement.',
    steps:[
      'Start tuck front lever; raise hips into horizontal line progressively.',
      'Controlled reps with scapula engaged.',
      'Progress: tuck → advanced tuck → straddle → full.'
    ],
    tips:'Short sets, focus on full tension.'
  },
  'Chin-ups':{ type:'pull', level:'intermediate', desc:'Biceps and lats focus; supinated grip.', steps:['Use underhand grip, pull chin above bar','Lower slow for eccentric strength'], tips:'Good for arm thickness.' },
  'Hanging leg raises':{ type:'core', level:'intermediate', desc:'Builds lower abs and hip flexors.', steps:['Hang tall, raise legs keeping torso still','Use strict motion; progress to toes-to-bar'], tips:'Avoid swinging; hollow shape.' },
  'Hanging windshield wipers':{ type:'core', level:'advanced', desc:'Rotational hanging core move for obliques and control.', steps:['Hang, raise legs to 90°, rotate legs side-to-side','Keep shoulders engaged'], tips:'Use bent knees if needed.' },
  'Dragon flags':{ type:'core', level:'advanced', desc:'Supreme core demand (Frank Zane/Briggs staple)', steps:['Lie on bench, grip behind head, lift body as a straight plank and lower controlled'], tips:['Start with negatives, keep body rigid'] },
  'Hollow body hold':{ type:'core', level:'beginner', desc:'Fundamental gymnastics core hold.', steps:['Lie back, press lower back to floor, lift shoulders and legs, hold'], tips:'Breathe and add time gradually' },
  'Side plank reach-throughs':{ type:'core', level:'intermediate', desc:'Oblique stability with dynamic reach.', steps:['Side plank, reach under torso with top hand then open'], tips:'Keep hips high' },
  'Mobility flow':{ type:'core', level:'all', desc:'15 minutes of joint prep (shoulders, hips, spine).', steps:['Shoulder dislocates, band pull-aparts, hip CARs, thoracic rotations'], tips:'Focus on tight areas' },
  'Clap push-ups':{ type:'explosive', level:'intermediate', desc:'Plyometric push for explosive upper body power.', steps:['Explode up from push-up and clap before landing'], tips:'Land soft and control descent' },
  'Muscle-up progressions':{ type:'explosive', level:'advanced', desc:'Transition pull→dip. Learn strict pull + transition drills.', steps:['Chest-to-bar pull-ups, transition drills on low rings, negatives'], tips:'Use false grip work on rings' },
  'Jump squats':{ type:'explosive', level:'beginner', desc:'Power training for legs & hip extension.', steps:['Squat then explode upward; soft landing'], tips:'Keep chest up; control depth' },
  'Burpee pull-ups':{ type:'explosive', level:'intermediate', desc:'Metabolic + pulling combo for conditioning.', steps:['Burpee under bar, then immediate pull-up'], tips:'Pace sets for quality' },
  'Sprint intervals':{ type:'explosive', level:'all', desc:'Short 100m sprints for conditioning & power.', steps:['10x100m with full recovery (90s-3min) or adjust to fitness level'], tips:'Prioritize rest for max effort' }
};

/* ====== Storage keys & util ====== */
const STORAGE_KEY = 'nightwing_tracker_v1';
let appState = JSON.parse(localStorage.getItem(STORAGE_KEY) || '{}');
if(!appState.logs) appState.logs = []; // array of {date, workoutId, exercise, sets, reps, note}
if(!appState.reminders) appState.reminders = {}; // {workoutId: "18:30"}
localStorage.setItem(STORAGE_KEY, JSON.stringify(appState));

/* ====== UI Wiring ====== */
const scheduleList = document.getElementById('scheduleList');
const exList = document.getElementById('exList');
const selectWorkout = document.getElementById('selectWorkout');
const selectExercise = document.getElementById('selectExercise');
const inputSets = document.getElementById('inputSets');
const inputReps = document.getElementById('inputReps');
const logBtn = document.getElementById('logBtn');
const clearBtn = document.getElementById('clearBtn');
const logArea = document.getElementById('logArea');
const todayLabel = document.getElementById('todayLabel');
const todayActions = document.getElementById('todayActions');
const remTime = document.getElementById('remTime');
const setRem = document.getElementById('setRem');
const askNotify = document.getElementById('askNotify');
const exportBtn = document.getElementById('exportBtn');
const importBtn = document.getElementById('importBtn');
const filterSelect = document.getElementById('filterSelect');

/* Default schedule mapping — you can edit these in UI later (simple approach) */
const DEFAULT_WEEK = [
  { day:'Monday', note:'Gym (Push) — optional rest from calisthenics' },
  { day:'Tuesday', workoutId:'pull' },
  { day:'Wednesday', note:'Gym (Legs)' },
  { day:'Thursday', workoutId:'push' },
  { day:'Friday', note:'Gym (Pull)' },
  { day:'Saturday', workoutId:'explosive' },
  { day:'Sunday', workoutId:'core' }
];

/* Populate schedule UI */
function renderSchedule(){
  scheduleList.innerHTML = '';
  DEFAULT_WEEK.forEach(d=>{
    const el = document.createElement('div');
    el.className='workout-item';
    const left = document.createElement('div');
    left.innerHTML = `<div style="font-weight:700">${d.day}</div><div class="small">${d.note ? d.note : (WORKOUTS.find(w=>w.id===d.workoutId)||{title:''}).title}</div>`;
    const right = document.createElement('div');
    if(d.workoutId){
      const b = document.createElement('button');
      b.textContent='Open';
      b.onclick = ()=> openWorkout(d.workoutId);
      right.appendChild(b);
    } else {
      const s = document.createElement('div'); s.className='small'; s.textContent='—';
      right.appendChild(s);
    }
    el.appendChild(left); el.appendChild(right);
    scheduleList.appendChild(el);
  });
}

/* Open a workout and show exercises */
function openWorkout(id){
  const w = WORKOUTS.find(x=>x.id===id);
  if(!w) return;
  window.scrollTo({top:0, behavior:'smooth'});
  // show a quick modal-like expand by opening the exercise section on the right filter and selecting
  filterSelect.value = w.tag;
  renderExercises();
}

/* render exercises list */
function renderExercises(){
  const filter = filterSelect.value;
  exList.innerHTML = '';
  const entries = Object.keys(EXERCISE_DB).filter(k=>{
    if(filter==='all') return true;
    return EXERCISE_DB[k].type === filter;
  }).sort();
  entries.forEach(name=>{
    const d = EXERCISE_DB[name];
    const item = document.createElement('details'); item.className='ex-item';
    const summ = document.createElement('summary');
    summ.innerHTML = `<div style="display:flex;justify-content:space-between;align-items:center"><div><strong>${name}</strong> <span class="small"> — ${d.level}</span></div><div class="small">${d.type}</div></div>`;
    item.appendChild(summ);
    const body = document.createElement('div');
    body.innerHTML = `<p class="small">${d.desc}</p>
      <div style="font-weight:700;margin-top:6px">How to</div>
      <ol>${d.steps.map(s=>`<li class="small">${s}</li>`).join('')}</ol>
      <div style="margin-top:8px"><span class="small" style="font-weight:700">Tip:</span> <span class="small">${Array.isArray(d.tips)?d.tips.join(' ') : d.tips}</span></div>
      <div style="margin-top:8px">
        <button onclick="quickSelect('${name}')">Use in quick log</button>
      </div>
    `;
    item.appendChild(body);
    exList.appendChild(item);
  });
}

/* quick select for logging */
function quickSelect(exName){
  // find which workout contains it
  let workoutId = '';
  for(const w of WORKOUTS){
    if(w.exercises.includes(exName)){ workoutId = w.id; break; }
  }
  if(workoutId){
    selectWorkout.value = workoutId;
    populateExercises();
  }
  selectExercise.value = exName;
}

/* Fill dropdowns */
function populateWorkoutSelects(){
  selectWorkout.innerHTML = WORKOUTS.map(w=>`<option value="${w.id}">${w.title}</option>`).join('');
  selectWorkout.onchange = populateExercises;
  populateExercises();
}

/* populate exercises for selected workout */
function populateExercises(){
  const id = selectWorkout.value;
  const w = WORKOUTS.find(x=>x.id===id);
  selectExercise.innerHTML = (w ? w.exercises : []).map(e=>`<option>${e}</option>`).join('');
}

/* Logging */
logBtn.onclick = ()=>{
  const workoutId = selectWorkout.value;
  const exercise = selectExercise.value;
  const sets = parseInt(inputSets.value) || 0;
  const reps = inputReps.value || '';
  if(!exercise){ alert('Choose an exercise'); return; }
  const entry = { date: new Date().toISOString(), workoutId, exercise, sets, reps, note:'' };
  appState.logs.push(entry); saveState(); renderLog();
};

/* Clear logs */
clearBtn.onclick = ()=>{
  if(!confirm('Clear all logs?')) return;
  appState.logs = []; saveState(); renderLog();
};

/* render log */
function renderLog(){
  logArea.innerHTML = '';
  const recent = appState.logs.slice().reverse();
  if(recent.length===0){ logArea.innerHTML = '<div class="small">No logs yet.</div>'; return; }
  recent.forEach(l=>{
    const d = new Date(l.date);
    const el = document.createElement('div');
    el.className = 'small';
    el.style.padding = '8px 0';
    el.innerHTML = `<div style="font-weight:700">${l.exercise}</div><div>${l.sets} sets • ${l.reps} • ${d.toLocaleString()}</div>`;
    logArea.appendChild(el);
  });
}

/* Save */
function saveState(){ localStorage.setItem(STORAGE_KEY, JSON.stringify(appState)); }

/* Export & import */
exportBtn.onclick = ()=>{
  const blob = new Blob([JSON.stringify(appState, null, 2)], {type:'application/json'});
  const url = URL.createObjectURL(blob);
  const a = document.createElement('a'); a.href = url; a.download = 'nightwing_tracker_export.json';
  document.body.appendChild(a); a.click(); a.remove(); URL.revokeObjectURL(url);
};
importBtn.onclick = ()=>{
  const inp = document.createElement('input'); inp.type='file'; inp.accept='.json';
  inp.onchange = e=>{
    const file = e.target.files[0]; if(!file) return;
    const reader = new FileReader();
    reader.onload = ev=>{
      try{
        const data = JSON.parse(ev.target.result);
        if(confirm('Replace local data with imported data? Current local data will be overwritten.')){
          appState = data; if(!appState.logs) appState.logs = []; if(!appState.reminders) appState.reminders={};
          saveState(); renderLog(); renderRemindersUI(); alert('Imported.');
        }
      }catch(err){ alert('Invalid file'); }
    };
    reader.readAsText(file);
  };
  inp.click();
};

/* Reminders: set per-workout time. Poll every minute. */
function renderRemindersUI(){
  // show current reminders under schedule items
  const nodes = scheduleList.querySelectorAll('.workout-item');
  // Re-render entire schedule to include reminder small text
  renderSchedule();
  // then add small reminder indicators
  DEFAULT_WEEK.forEach(d=>{
    if(!d.workoutId) return;
    const rem = appState.reminders[d.workoutId];
    // find matching element by day text
    const items = Array.from(scheduleList.children).filter(n=> n.querySelector('div').textContent.includes(d.day));
    if(items[0]){
      const right = items[0].querySelector('div:last-child');
      const small = document.createElement('div');
      small.className='small';
      small.style.marginTop='6px';
      small.textContent = rem ? `Reminder: ${rem}` : 'No reminder set';
      right.appendChild(small);
    }
  });
}
setRem.onclick = ()=>{
  const time = remTime.value;
  const workoutId = selectWorkout.value || 'push';
  appState.reminders[workoutId] = time;
  saveState(); renderRemindersUI(); alert('Reminder set for selected workout at '+time);
};

/* Notification permission */
askNotify.onclick = async ()=>{
  if(!('Notification' in window)){ alert('Notifications not supported in this browser'); return; }
  const perm = await Notification.requestPermission();
  if(perm === 'granted') alert('Notifications enabled. Keep this app open for reminders to fire.');
  else alert('Notification permission denied or dismissed. Reminders will not show.');
};

/* Polling loop (every 30s) checks reminders and shows notification if a match */
let lastNotified = {}; // to avoid repeats within same minute
setInterval(()=> checkReminders(), 30*1000);
function checkReminders(){
  if(Notification.permission !== 'granted') return;
  const now = new Date();
  const hhmm = now.toTimeString().slice(0,5);
  // find today's scheduled workout(s)
  const dayName = now.toLocaleDateString(undefined,{weekday:'long'});
  const todays = DEFAULT_WEEK.filter(d=>d.day === dayName).map(d=>d.workoutId).filter(Boolean);
  todays.forEach(workoutId=>{
    const rem = appState.reminders[workoutId];
    if(!rem) return;
    if(rem === hhmm && lastNotified[workoutId] !== hhmm){
      lastNotified[workoutId] = hhmm;
      const w = WORKOUTS.find(x=>x.id===workoutId);
      const notif = new Notification('Workout Reminder — '+(w? w.title : 'Calisthenics'), {
        body: `Time for ${w? w.title.split('—')[0].trim() : 'your calisthenics session'} — open app to start tracking.`,
        tag: 'nightwing-workout-'+workoutId
      });
      notif.onclick = ()=> window.focus();
    }
  });
}

/* Today quick actions */
function renderToday(){
  const now = new Date();
  const dayName = now.toLocaleDateString(undefined,{weekday:'long'});
  todayLabel.textContent = `${dayName} — ${now.toLocaleDateString()}`;
  todayActions.innerHTML = '';
  const todays = DEFAULT_WEEK.filter(d=>d.day===dayName);
  if(todays.length && todays[0].workoutId){
    const wid = todays[0].workoutId;
    const w = WORKOUTS.find(x=>x.id===wid);
    const b = document.createElement('button'); b.textContent='Start Session';
    b.onclick = ()=> {
      // jump to workout in UI by selecting it
      selectWorkout.value = wid; populateExercises();
      window.scrollTo({top: document.getElementById('selectWorkout').getBoundingClientRect().top + window.scrollY - 60, behavior:'smooth'});
    };
    todayActions.appendChild(b);
    const info = document.createElement('div'); info.className='small'; info.style.marginTop='8px';
    info.textContent = 'Planned: ' + w.title;
    todayActions.appendChild(info);
  } else {
    todayActions.innerHTML = '<div class="small">No calisthenics planned today — use app to log extras.</div>';
  }
}

/* Initialization */
function init(){
  renderSchedule();
  populateWorkoutSelects();
  renderExercises();
  renderLog();
  renderToday();
  renderRemindersUI();
}
init();

/* utility to open workout when called from UI inline */
window.openWorkout = openWorkout;
window.quickSelect = quickSelect;

</script>
</body>
</html>
